     1                                 %line 1+1 fi.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 %line 1+1 macro.inc
     9                                 
    10                                 
    11                                 
    12                                 
    13                                 
    14                                 
    15                                 
    16                                 LF equ 10
    17                                 TAB equ 9
    18                                 ESC equ 27
    19                                 SPACE equ 32
    20                                 EOL equ 0
    21                                 VAR_SIZE equ 8
    22                                 MAX_PATH equ 4096
    23                                 false equ 0
    24                                 true equ 1
    25                                 EXIT_SUCCESS equ 0
    26                                 EXIT_FAILURE equ 1
    27                                 
    28                                 __S_IFMT equ 0170000
    29                                 
    30                                 [default rel]
    31                                 
    32                                 [extern printf]
    33                                 %line 24+0 macro.inc
    34                                 [extern puts]
    35                                 %line 25+1 macro.inc
    36                                 [extern strcmp]
    37                                 %line 25+0 macro.inc
    38                                 [extern strcat]
    39                                 [extern strlen]
    40                                 %line 26+1 macro.inc
    41                                 [extern strncmp]
    42                                 [extern strncpy]
    43                                 %line 27+0 macro.inc
    44                                 [extern strcpy]
    45                                 %line 28+1 macro.inc
    46                                 [extern strcasecmp]
    47                                 [extern malloc]
    48                                 %line 29+0 macro.inc
    49                                 [extern free]
    50                                 %line 30+1 macro.inc
    51                                 [extern memcpy]
    52                                 %line 30+0 macro.inc
    53                                 [extern memmove]
    54                                 %line 31+1 macro.inc
    55                                 [extern chdir]
    56                                 %line 31+0 macro.inc
    57                                 [extern strncat]
    58                                 [extern getcwd]
    59                                 %line 32+1 macro.inc
    60                                 [extern lstat]
    61                                 %line 32+0 macro.inc
    62                                 [extern getpwnam]
    63                                 %line 33+1 macro.inc
    64                                 [extern opendir]
    65                                 %line 33+0 macro.inc
    66                                 [extern readdir]
    67                                 [extern closedir]
    68                                 %line 34+1 macro.inc
    69                                 [extern getpwuid]
    70                                 %line 34+0 macro.inc
    71                                 [extern getgrgid]
    72                                 %line 35+1 macro.inc
    73                                 [extern readlink]
    74                                 [extern perror]
    75                                 
    76                                 
    77                                 
    78                                 %line 43+1 macro.inc
    79                                 
    80                                 %line 48+1 macro.inc
    81                                 
    82                                 %line 53+1 macro.inc
    83                                 
    84                                 %line 58+1 macro.inc
    85                                 
    86                                 %line 63+1 macro.inc
    87                                 
    88                                 %line 68+1 macro.inc
    89                                 
    90                                 %line 73+1 macro.inc
    91                                 
    92                                 %line 78+1 macro.inc
    93                                 
    94                                 %line 82+1 macro.inc
    95                                 
    96                                 %line 86+1 macro.inc
    97                                 
    98                                 %line 91+1 macro.inc
    99                                 
   100                                 %line 95+1 macro.inc
   101                                 
   102                                 %line 100+1 macro.inc
   103                                 
   104                                 %line 104+1 macro.inc
   105                                 
   106                                 %line 109+1 macro.inc
   107                                 
   108                                 %line 115+1 macro.inc
   109                                 
   110                                 %line 120+1 macro.inc
   111                                 
   112                                 %line 126+1 macro.inc
   113                                 
   114                                 %line 132+1 macro.inc
   115                                 
   116                                 %line 137+1 macro.inc
   117                                 
   118                                 %line 142+1 macro.inc
   119                                 
   120                                 %line 147+1 macro.inc
   121                                 
   122                                 %line 153+1 macro.inc
   123                                 
   124                                 %line 160+1 macro.inc
   125                                 
   126                                 %line 164+1 macro.inc
   127                                 
   128                                 %line 169+1 macro.inc
   129                                 
   130                                 %line 173+1 macro.inc
   131                                 
   132                                 %line 179+1 macro.inc
   133                                 
   134                                 %line 185+1 macro.inc
   135                                 
   136                                 %line 189+1 macro.inc
   137                                 
   138                                 %line 196+1 macro.inc
   139                                 
   140                                 %line 200+1 macro.inc
   141                                 
   142                                 %line 205+1 macro.inc
   143                                 
   144                                 %line 212+1 macro.inc
   145                                 
   146                                 %line 219+1 macro.inc
   147                                 
   148                                 %line 223+1 macro.inc
   149                                 
   150                                 %line 229+1 macro.inc
   151                                 
   152                                 %line 234+1 macro.inc
   153                                 
   154                                 %line 239+1 macro.inc
   155                                 
   156                                 %line 243+1 macro.inc
   157                                 
   158                                 %line 248+1 macro.inc
   159                                 
   160                                 %line 253+1 macro.inc
   161                                 
   162                                 %line 258+1 macro.inc
   163                                 
   164                                 %line 262+1 macro.inc
   165                                 
   166                                 %line 267+1 macro.inc
   167                                 
   168                                 %line 272+1 macro.inc
   169                                 
   170                                 %line 279+1 macro.inc
   171                                 
   172                                 %line 289+1 macro.inc
   173                                 
   174                                 %line 293+1 macro.inc
   175                                 
   176                                 %line 298+1 macro.inc
   177                                 
   178                                 %line 304+1 macro.inc
   179                                 
   180                                 %line 308+1 macro.inc
   181                                 
   182                                 %line 312+1 macro.inc
   183                                 
   184                                 %line 317+1 macro.inc
   185                                 
   186                                 %line 321+1 macro.inc
   187                                 
   188                                 %line 326+1 macro.inc
   189                                 
   190                                 %line 331+1 macro.inc
   191                                 
   192                                 %line 336+1 macro.inc
   193                                 
   194                                 %line 341+1 macro.inc
   195                                 
   196                                 %line 346+1 macro.inc
   197                                 
   198                                 %line 350+1 macro.inc
   199                                 
   200                                 %line 355+1 macro.inc
   201                                 
   202                                 %line 359+1 macro.inc
   203                                 
   204                                 %line 366+1 macro.inc
   205                                 
   206                                 %line 370+1 macro.inc
   207                                 
   208                                 %line 375+1 macro.inc
   209                                 
   210                                 %line 379+1 macro.inc
   211                                 
   212                                 %line 8+1 fi.asm
   213                                 
   214                                 [global main]
   215                                 
   216                                 
   217                                 [section .text]
   218                                 
   219                                 
   220                                 printFileInfo:
   221 00000000 55                      push rbp
   222                                 %line 16+0 fi.asm
   223 00000001 4889E5                  mov rbp, rsp
   224                                 %line 17+1 fi.asm
   225 00000004 4881ECB0000000          sub rsp, 176
   226                                 
   227 0000000B 8D3D(F4FFFFFF)          lea edi, [pFilePath]
   228 00000011 8DB558FFFFFF            lea esi, [rbp - 168]
   229 00000017 E8(F6FFFFFF)            call lstat
   230                                 %line 21+0 fi.asm
   231 0000001C 85C0                    test eax, eax
   232                                 %line 22+1 fi.asm
   233 0000001E 753A                    jnz .err1
   234                                 
   235 00000020 8D3D(F4FFFFFF)          lea edi, [filePathFmt]
   236 00000026 488D35(F2FFFFFF)        lea rsi, [pFilePath]
   237 0000002D 31C0                    xor eax, eax
   238                                 %line 26+0 fi.asm
   239 0000002F E8(F6FFFFFF)            call printf
   240                                 %line 27+1 fi.asm
   241                                 
   242 00000034 488D3D(F2FFFFFF)        lea rdi, [uidgidFmt]
   243 0000003B 8B7580                  mov esi, dword [rbp - 128]
   244 0000003E 8B957CFFFFFF            mov edx, dword [rbp - 132]
   245 00000044 31C0                    xor eax, eax
   246                                 %line 31+0 fi.asm
   247 00000046 E8(F6FFFFFF)            call printf
   248                                 %line 32+1 fi.asm
   249                                 
   250 0000004B 488D3D(F2FFFFFF)        lea rdi, [fileSizeFmt]
   251 00000052 8B7590                  mov esi, [rbp - 112]
   252 00000055 31C0                    xor eax, eax
   253                                 %line 35+0 fi.asm
   254 00000057 E8(F6FFFFFF)            call printf
   255                                 %line 36+1 fi.asm
   256                                 
   257                                 .err1:
   258 0000005C C9                      leave
   259 0000005D C3                      ret
   260                                 
   261                                 .fin:
   262 0000005E 31C0                    xor eax, eax
   263 00000060 C9                      leave
   264 00000061 C3                      ret
   265                                 
   266                                 
   267                                 main:
   268 00000062 55                      push rbp
   269                                 %line 48+0 fi.asm
   270 00000063 4889E5                  mov rbp, rsp
   271 00000066 4883EC10                sub rsp, 2 * 8
   272                                 %line 49+1 fi.asm
   273 0000006A 488D3D(F2FFFFFF)        lea rdi, [pFilePath]
   274 00000071 E885FFFFFF              call printFileInfo
   275                                 
   276                                 .fin:
   277 00000076 C9                      leave
   278                                 %line 53+0 fi.asm
   279 00000077 C3                      ret
   280                                 %line 54+1 fi.asm
   281                                 
   282                                 
   283                                 
   284                                 [section .bss]
   285                                 [absolute 0]
   286                                 %line 58+0 fi.asm
   287                                 stat:
   288                                 %line 59+1 fi.asm
   289                                  st_dev resw 1
   290                                  st_ino resq 1
   291                                  st_mode resd 1
   292                                  st_nlink resq 1
   293                                  st_uid resd 1
   294                                  st_gid resd 1
   295                                  st_rdev resq 1
   296                                  st_size resq 1
   297                                  st_blksize resq 1
   298                                  st_blocks resq 1
   299                                  st_atime resq 1
   300                                  st_mtime resq 1
   301                                  st_ctime resq 1
   302                                 stat_size EQU $ - stat
   303                                 %line 72+0 fi.asm
   304                                 [section .bss]
   305                                 %line 73+1 fi.asm
   306                                 
   307                                 st :
   308                                 %line 74+0 fi.asm
   309                                 ..@34.strucstart:
   310                                 %line 75+1 fi.asm
   311 00000000 00<rept>               times stat_size-($-..@34.strucstart) db 0
   312                                 
   313                                 [section .data]
   314 00000000 46696C652053697A65-    fileSizeFmt db "File Size: %d", LF, EOL
   315 00000000 3A2025640A00       
   316 0000000F 46696C652050617468-    filePathFmt db "File Path: %s", LF, EOL
   317 0000000F 3A2025730A00       
   318 0000001E 2F686F6D652F6A732F-    pFilePath db "/home/js/Development/asm_x86_64/userAsm/fi", EOL
   319 0000001E 446576656C6F706D65-
   320 0000001E 6E742F61736D5F7838-
   321 0000001E 365F36342F75736572-
   322 0000001E 41736D2F666900     
   323 00000049 7569643A2025642067-    uidgidFmt db "uid: %d gid: %d", LF, EOL
   324 00000049 69643A2025640A00   
   325                                 
   326                                 
